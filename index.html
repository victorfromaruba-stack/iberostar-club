<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- VIEWPORT: Fixed to prevent zooming on inputs, optimized for all screens -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <!-- APPLE PWA SETTINGS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Iberostar Aruba">
    
    <!-- APP ICON -->
    <link rel="apple-touch-icon" href="Logos/app_logo_club.png?v=7"> 
    <link rel="shortcut icon" href="Logos/app_logo_club.png?v=7" type="image/png">
    
    <!-- TYPOGRAPHY -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,600;0,700;1,600&display=swap" rel="stylesheet">

    <title>Iberostar Aruba</title>

    <!-- IMAGE ERROR HANDLER -->
    <script>
        function handleImgError(img) {
            // Prevent infinite loops
            if (img.getAttribute('data-tried-fix') === 'true') return;
            img.setAttribute('data-tried-fix', 'true');

            // 1. LOGOS: Try to swap extensions if PNG fails, but DO NOT switch to SVG
            if (img.classList.contains('header-logo') || img.classList.contains('splash-logo')) {
                const src = img.src;
                if (src.endsWith('.png')) {
                    // Try .jpg just in case, otherwise stop.
                    img.src = src.replace('.png', '.jpg');
                }
                // If it fails again, we just let it be (or user can fix file path), 
                // but we won't replace it with the generic Star SVG you didn't like.
                return;
            }

            // 2. MAIN MODAL IMAGE: Show a nice placeholder if main image is missing
            if (img.id === 'dImg') {
                img.src = 'https://images.unsplash.com/photo-1566073771259-6a8506099945?auto=format&fit=crop&w=1200&q=80';
                return;
            }

            // 3. CARDS/GALLERY: Remove container if image fails
            const src = img.src;
            if (src.includes('.jpg')) {
                img.src = src.replace('.jpg', '.png');
            } else if (src.includes('.png')) {
                img.src = src.replace('.png', '.jpg');
            } else {
                // If extension swap fails, remove the container so no "broken image" icon shows
                if (img.closest('.gallery-item')) img.closest('.gallery-item').remove();
                else if (img.closest('.card-media')) img.src = 'https://images.unsplash.com/photo-1540541338287-41700207dee6?auto=format&fit=crop&w=800&q=80'; // Card fallback
            }
        }
    </script>

    <style>
        /* --- CSS VARIABLES --- */
        :root {
            --bg-gradient-1: #4facfe;
            --bg-gradient-2: #00f2fe;
            --ocean-deep: #0F2D4A; 
            --gold: #C5A065;
            --glass-card: rgba(255, 255, 255, 0.85);
            --glass-nav: rgba(255, 255, 255, 0.9);
            --glass-border: rgba(255, 255, 255, 0.6);
            --text-main: #0F2D4A;
            --text-muted: #425b76;
            --font-head: 'Playfair Display', serif;
            --font-body: 'Inter', sans-serif;
        }

        body.dark-theme {
            --text-main: #FFFFFF;
            --text-muted: rgba(255, 255, 255, 0.8);
            --glass-card: rgba(15, 23, 42, 0.7);
            --glass-nav: rgba(15, 23, 42, 0.85);
            --glass-border: rgba(255, 255, 255, 0.1);
            --ocean-deep: #FFFFFF;
        }

        /* PRELOAD FIX */
        body.preload *:not(#splash):not(.splash-logo) {
            transition: none !important;
            animation: none !important;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; -webkit-font-smoothing: antialiased; }
        
        body {
            margin: 0;
            font-family: var(--font-body);
            background-color: #FDFBF7;
            color: var(--text-main);
            height: 100vh;
            /* SAFE AREA PADDING */
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            padding-left: env(safe-area-inset-left);
            padding-right: env(safe-area-inset-right);
            display: flex;
            overflow: hidden;
            background: linear-gradient(180deg, var(--bg-gradient-1) 0%, var(--bg-gradient-2) 100%);
            transition: background 2.5s ease;
        }

        /* --- LOADING SPLASH (HUGE LOGO) --- */
        #splash {
            position: fixed; inset: 0; z-index: 999999; 
            background: #fff; display: flex; align-items: center; justify-content: center;
            transition: opacity 0.8s ease; opacity: 1;
        }
        .splash-logo {
            width: 500px; /* Big Size */
            max-width: 80%;
            height: auto;
            object-fit: contain;
            animation: pulseLogo 2s infinite ease-in-out;
        }
        @keyframes pulseLogo { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        /* --- BACKGROUND ANIMATIONS --- */
        .ocean-waves { position: absolute; inset: 0; pointer-events: none; z-index: 0; background-image: url("data:image/svg+xml,%3Csvg width='100' height='20' viewBox='0 0 100 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M21.184 20c.357-.13.72-.264 1.088-.402l1.768-.661C33.64 15.347 39.647 14 50 14c10.271 0 15.362 1.222 24.629 4.928.955.383 1.869.74 2.75 1.072h6.225c-2.51-.73-5.139-1.691-8.233-2.928C65.888 13.278 60.562 12 50 12c-10.626 0-16.855 1.397-26.66 5.063l-1.767.662c-2.475.923-4.66 1.674-6.724 2.275h6.335zm0-20C13.258 2.892 8.077 4 0 4V2c5.744 0 9.951-.574 14.85-2h6.334zM77.38 0C85.239 2.966 90.502 4 100 4V2c-6.842 0-11.386-.542-16.396-2h-6.225zM0 14c8.44 0 13.718-1.21 22.272-4.402l1.768-.661C33.64 5.347 39.647 4 50 4c10.271 0 15.362 1.222 24.629 4.928C84.112 12.722 89.438 14 100 14v-2c-10.271 0-15.362-1.222-24.629-4.928C65.888 3.278 60.562 2 50 2 39.374 2 33.145 3.397 23.34 7.063l-1.767.662C13.223 10.84 8.163 12 0 12v2z' fill='%23ffffff' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E"); opacity: 0.2; }
        .palm-shadows { position: absolute; inset: 0; pointer-events: none; z-index: 1; background: radial-gradient(circle at 100% 0%, rgba(0,0,0,0.05) 0%, transparent 40%); opacity: 0; transition: opacity 3s; }
        .shadows-active { opacity: 1; }
        .night-glow { position: absolute; bottom: 0; left: 0; width: 100%; height: 60vh; background: linear-gradient(to top, rgba(212, 175, 55, 0.15), transparent); opacity: 0; z-index: 0; transition: opacity 3s; }
        .glow-active { opacity: 1; }

        /* --- SIDEBAR (CENTERED FLOATING DOCK) --- */
        nav {
            position: fixed; 
            left: 24px; 
            top: 50%; 
            transform: translateY(-50%); /* Keeps it perfectly centered vertically */
            
            width: 140px; /* Thicker but not too thick */
            height: 85vh; /* Dock style, doesn't touch top/bottom edges */
            
            background: var(--glass-nav); backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px);
            border-radius: 40px; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            border: 1px solid var(--glass-border); 
            box-shadow: 0 25px 50px rgba(0,0,0,0.15); 
            z-index: 100;
        }
        
        .nav-btn {
            width: 100px; height: 100px; /* Big touch targets */
            border-radius: 30px; 
            margin-bottom: 20px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: transparent; border: none; color: var(--text-muted); cursor: pointer;
            transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
        }
        
        .nav-btn svg { 
            width: 44px; height: 44px; /* Large readable icons */
            fill: currentColor; transition: transform 0.3s; 
        }
        
        .nav-btn.active { 
            background: var(--gold); 
            color: white; 
            box-shadow: 0 15px 30px rgba(197, 160, 101, 0.4); 
            transform: scale(1.05);
        }
        .nav-btn.active svg { fill: white; transform: scale(1.1); }

        /* --- MAIN LAYOUT --- */
        main { 
            flex: 1; height: 100vh; overflow-y: auto; overflow-x: hidden; 
            /* Padding Left = Sidebar Width (140) + Left Gap (24) + Extra Gap (40) */
            padding: 60px 60px 60px 220px; 
            scroll-behavior: smooth; z-index: 10; -webkit-overflow-scrolling: touch;
        }
        main::-webkit-scrollbar { display: none; }

        header { margin-bottom: 50px; }
        .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        
        /* HEADER LOGO BIG */
        .header-logo { height: 120px; width: auto; object-fit: contain; transition: filter 0.5s; }
        .logo-white { filter: brightness(0) invert(1); }

        .greeting { font-family: var(--font-body); font-size: 1rem; text-transform: uppercase; letter-spacing: 2px; color: var(--gold); font-weight: 800; text-align: right; }
        .date-display { font-family: var(--font-body); font-size: 1.1rem; color: var(--text-muted); margin-top: 4px; font-weight: 500; text-align: right; }

        h1 { 
            font-family: var(--font-head); font-size: 4.5rem; font-weight: 700; color: var(--text-main); margin: 0; letter-spacing: -1.5px; 
            opacity: 0; animation: fadeUp 0.8s 0.2s forwards;
        }
        .subtitle { font-family: var(--font-body); font-size: 1.5rem; color: var(--text-muted); margin-top: 10px; max-width: 600px; font-weight: 300; opacity: 0; animation: fadeUp 0.8s 0.3s forwards; }

        .search-container { margin-top: 35px; position: relative; max-width: 500px; opacity: 0; animation: fadeUp 0.8s 0.4s forwards; display: none; }
        .search-input {
            width: 100%; padding: 20px 24px 20px 60px; border-radius: 24px;
            border: 1px solid var(--glass-border); background: var(--glass-card);
            backdrop-filter: blur(20px); font-size: 1.1rem; color: var(--text-main); font-family: var(--font-body);
            box-shadow: 0 10px 30px rgba(0,0,0,0.03); transition: all 0.3s ease;
        }
        .search-input:focus { background: white; border-color: var(--gold); box-shadow: 0 15px 40px rgba(197, 160, 101, 0.15); }
        body.dark-theme .search-input:focus { background: rgba(30, 60, 90, 0.9); }
        .search-icon { position: absolute; left: 24px; top: 50%; transform: translateY(-50%); width: 22px; height: 22px; fill: var(--gold); pointer-events: none; }

        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* --- GRID & TRANSITION --- */
        .fade-wrapper { animation: fadeInSection 0.5s cubic-bezier(0.23, 1, 0.32, 1); }
        @keyframes fadeInSection { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); 
            gap: 40px; padding-bottom: 120px; 
        }
        
        .card {
            background: var(--glass-card); backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border); border-radius: 35px;
            overflow: hidden; position: relative; cursor: pointer;
            box-shadow: 0 15px 35px rgba(0,0,0,0.05);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .card:hover { box-shadow: var(--shadow-hover); border-color: var(--gold); z-index: 10; }
        .card:active { transform: scale(0.97); }
        
        .card-media { height: 240px; position: relative; overflow: hidden; background: #eee; }
        .card-img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s; }
        
        .tag-pill { position: absolute; top: 20px; left: 20px; background: rgba(255,255,255,0.95); padding: 8px 16px; border-radius: 12px; font-size: 0.75rem; font-weight: 800; text-transform: uppercase; color: #0F2D4A; z-index: 2; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .cash-badge { position: absolute; bottom: 20px; left: 20px; background: rgba(15, 45, 74, 0.9); color: var(--gold); padding: 6px 12px; border-radius: 8px; font-size: 0.7rem; font-weight: 700; z-index: 2; }
        
        .media-badge {
            position: absolute; top: 20px; right: 20px;
            width: 44px; height: 44px; border-radius: 50%;
            background: rgba(255,255,255,0.95); backdrop-filter: blur(4px);
            display: flex; align-items: center; justify-content: center; z-index: 5;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        .media-badge:active { transform: scale(0.9); }
        .media-badge svg { width: 20px; height: 20px; fill: #0F2D4A; }
        
        .partner-badge { position: absolute; bottom: 15px; right: 15px; width: 40px; height: 40px; background: white; border-radius: 50%; padding: 5px; z-index: 2; box-shadow: 0 4px 10px rgba(0,0,0,0.1); object-fit: contain; }

        .card-content { padding: 30px; }
        .card-title { font-family: var(--font-head); font-size: 1.8rem; margin: 0 0 10px 0; color: var(--text-main); }
        .card-desc { font-family: var(--font-body); font-size: 1rem; color: var(--text-muted); line-height: 1.6; margin: 0; }

        /* --- MODAL --- */
        .modal-wrap {
            position: fixed; inset: 0; z-index: 2000;
            background: rgba(0,0,0,0.3); backdrop-filter: blur(20px);
            display: flex; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: opacity 0.3s;
        }
        .modal-wrap.active { opacity: 1; pointer-events: all; }
        
        .modal {
            width: 85vw; height: 90vh; background: #fff; border-radius: 40px;
            display: flex; flex-direction: column; overflow: hidden;
            box-shadow: 0 50px 100px rgba(0,0,0,0.3);
            transform: translateY(50px); transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);
        }
        body.dark-theme .modal { background: #1a1a1a; }
        .modal-wrap.active .modal { transform: translateY(0); }

        .modal-hero { height: 45vh; position: relative; background: #eee; }
        .modal-hero img { width: 100%; height: 100%; object-fit: cover; }
        
        .modal-close-btn {
            position: absolute; top: 30px; right: 30px; width: 50px; height: 50px;
            background: rgba(255,255,255,0.8); border-radius: 50%; border: none;
            font-size: 24px; cursor: pointer; z-index: 10;
        }

        .modal-content { padding: 50px; overflow-y: auto; flex: 1; }
        .modal-title { font-family: var(--font-head); font-size: 3.5rem; margin: 0 0 10px 0; color: var(--text-main); }
        .modal-sub { color: var(--gold); font-weight: 800; text-transform: uppercase; letter-spacing: 2px; }
        .modal-text { font-size: 1.2rem; line-height: 1.8; color: var(--text-muted); margin-top: 20px; }

        /* --- GALLERY IN MODAL --- */
        .gallery-scroller { display: flex; gap: 20px; overflow-x: auto; padding: 20px 0; margin-top: 40px; }
        .gallery-item { 
            width: 280px; height: 200px; flex-shrink: 0; border-radius: 20px; overflow: hidden; background: #ddd;
            position: relative; cursor: pointer;
        }
        .gallery-item img { width: 100%; height: 100%; object-fit: cover; }

        /* --- FULLSCREEN VIEWER --- */
        .fs-viewer { position: fixed; inset: 0; background: black; z-index: 3000; display: none; justify-content: center; align-items: center; }
        .fs-viewer.active { display: flex; }
        .fs-img { max-width: 100%; max-height: 100%; object-fit: contain; }
        .fs-close { position: absolute; top: 40px; right: 40px; color: white; background: rgba(255,255,255,0.2); width: 60px; height: 60px; border-radius: 50%; font-size: 30px; border: none; }

        /* MEDIA QUERY FOR PHONES (Keep mobile functional) */
        @media (max-width: 768px) {
            nav { width: 100%; height: 80px; bottom: 0; margin: 0; border-radius: 0; flex-direction: row; position: fixed; top: auto; left: 0; right: 0; background: rgba(255,255,255,0.95); transform: none; }
            .nav-btn { width: auto; height: 100%; margin: 0; flex: 1; background: none !important; box-shadow: none !important; }
            .nav-btn svg { width: 28px; height: 28px; fill: #aaa; }
            .nav-btn.active svg { fill: var(--gold); transform: scale(1.2); }
            main { padding: 20px 20px 120px 20px; }
            h1 { font-size: 3rem; }
            .modal { width: 100%; height: 100%; border-radius: 0; }
        }
    </style>
</head>
<body class="preload">

    <!-- ATMOSPHERE -->
    <div class="ocean-waves"></div>
    <div class="palm-shadows" id="palmShadows"></div>
    <div class="night-glow" id="nightGlow"></div>

    <!-- LOADING SCREEN (FIXED BIGGER) -->
    <div id="splash">
        <!-- Reverted to PNG per instructions -->
        <img src="Logos/app_logo_club.png" class="splash-logo" onerror="handleImgError(this)" alt="Loading...">
    </div>

    <!-- SIDEBAR -->
    <nav>
        <button class="nav-btn active" onclick="nav('portfolio')">
            <svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
        </button>
        <button class="nav-btn" onclick="nav('dining')">
            <svg viewBox="0 0 24 24"><path d="M11 9H9V2H7v7H5V2H3v7c0 2.12 1.66 3.84 3.75 3.97V22h2.5v-9.03C11.34 12.84 13 11.12 13 9V2h-2v7zm5-3v8h2.5v8H21V2c-2.76 0-5 2.24-5 4z"/></svg>
        </button>
        <button class="nav-btn" onclick="nav('activities')">
            <svg viewBox="0 0 24 24"><path d="M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7"/></svg>
        </button>
        <button class="nav-btn" onclick="nav('spa')">
            <svg viewBox="0 0 24 24"><path d="M12 2C9 7 4 9 4 14c0 3 3 5 8 5s8-2 8-5c0-5-5-7-8-12zm0 18c-4.4 0-8-1.8-8-5 0-2.4 2.3-4.5 5-5.8 1.5 1.7 3 3.4 3 5.8 0-2.4 1.5-4.1 3-5.8 2.7 1.3 5 3.4 5 5.8 0 3.2-3.6 5-8 5z"/></svg>
        </button>
        <button class="nav-btn" onclick="nav('golf')">
            <svg viewBox="0 0 24 24"><path d="M19.5 19.5c-1 0-1.7-.6-2.1-1.5l-2.9-6.2c-.2-.4-.3-.8-.3-1.3 0-.2 0-.4.1-.6l.5-1.9c.2-.8-.2-1.7-1-2L12 5.5c-.1 0-.2-.1-.3-.1-1 0-1.8.7-2 1.7l-.3 1.7c-.2.9-.9 1.6-1.8 1.9l-2.1.6C4.7 11.6 4 12.4 4 13.3v.2c0 1 .6 1.9 1.5 2.3l2.2.9c.8.3 1.3 1.1 1.3 1.9v1.1c0 1.5 1.2 2.8 2.8 2.8h5.9c1 0 1.8-.8 1.8-1.8v-1.2zm-10-17c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2z"/></svg>
        </button>
    </nav>

    <main id="mainContainer">
        <header>
            <div class="header-top">
                <!-- Reverted to PNG per instructions -->
                <img src="Logos/logo_club.png" class="header-logo" id="headerLogo" onerror="handleImgError(this)" alt="Logo">
                <div onclick="toggleTime()">
                    <div class="greeting" id="greeting">BON BINI</div>
                    <div class="date-display" id="dateDisplay">...</div>
                </div>
            </div>
            <h1 id="pageTitle">Iberostar Aruba</h1>
            <p class="subtitle" id="pageSub">Experience the ultimate Iberostar hotels on Aruba.</p>
            
            <div class="search-container" id="searchBox">
                <svg class="search-icon" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                <input type="text" id="searchInput" class="search-input" placeholder="Search dining, tours, or hotels..." onkeyup="filterContent()">
            </div>
        </header>
        <div id="appContent"></div>
    </main>

    <!-- MODAL -->
    <div class="modal-wrap" id="detailModal">
        <div class="modal">
            <button class="modal-close-btn" onclick="closeModal()">✕</button>
            <div class="modal-hero">
                <img id="dImg" src="" onerror="handleImgError(this)">
            </div>
            <div class="modal-content">
                <div class="modal-sub" id="dSub">SUB</div>
                <h2 class="modal-title" id="dTitle">Title</h2>
                <div id="dDetails"></div>
                <p class="modal-text" id="dDesc">Description</p>
                
                <h4 style="margin-top:40px; font-family:var(--font-head); font-size:2rem; color:var(--text-main);">Gallery</h4>
                <div class="gallery-scroller" id="dGallery"></div>
            </div>
        </div>
    </div>

    <!-- FS VIEWER -->
    <div class="fs-viewer" id="fsViewer" onclick="this.classList.remove('active')">
        <button class="fs-close">✕</button>
        <img class="fs-img" id="fsImg" src="">
        <div id="fsVideoContainer" style="width:100%; height:100%; display:none; align-items:center; justify-content:center;"></div>
    </div>

    <script>
        // DATA
        const appData = {
            'Joia': { type:'club', title: 'Iberostar Joia', sub: 'Eagle Beach', desc: 'Experience the crown jewel of Aruba. Located on the pristine shores of Eagle Beach, Joia is an adults-only haven offering butler service, swim-up suites, and a level of exclusivity that redefines Caribbean luxury.', gallery: ['Hotels/Joia/hotel_joia_1.jpg', 'Hotels/Joia/hotel_joia_2.jpg', 'Hotels/Joia/hotel_joia_3.jpg'], img: 'Hotels/Joia/hotel_joia_1.jpg', video: 'Hotels/Joia/hotel_joia.mp4' },
            'Tierra': { type:'club', title: 'Tierra del Sol', sub: 'Golf & Estates', desc: 'Escape to the island\'s most prestigious gated community. Featuring luxury villas, a championship golf course, and panoramic views of the California Lighthouse and rugged North Coast.', gallery: ['Hotels/Tierra/golf_tierra_1.jpg', 'Hotels/Tierra/golf_tierra_2.jpg', 'Hotels/Tierra/golf_tierra_3.jpg', 'Hotels/Tierra/golf_tierra_4.jpg'], img: 'Hotels/Tierra/golf_tierra_1.jpg', video: 'Hotels/Tierra/golf_tierra.mp4' },
            'Selection': { type:'club', title: 'Iberostar Selection', sub: 'Coming Soon', desc: 'Bringing the premium Selection family experience to the Caribbean. Designed for families who refuse to compromise on luxury.', gallery: ['Hotels/Selection/hotel_selection_1.png'], img: 'Hotels/Selection/hotel_selection_1.png' },
            
            'Screaming': { type:'food', title: 'Screaming Eagle', sub: 'French Fusion', desc: 'Inspired by French-fusion cuisine, dinner in bed experience.', gallery: ['Restaurants/Screaming%20Eagle/rest_screaming_1.jpg'], img: 'Restaurants/Screaming%20Eagle/rest_screaming_1.jpg', pdf: 'Restaurants/Screaming%20Eagle/menu.pdf' },
            'Giannis': { type:'food', title: 'Gianni\'s Ristorante', sub: 'Italian', desc: 'Famous for the Spaghetti al Formaggio Parmigiano.', gallery: ['Restaurants/Gianni%27s%20Ristorante/rest_giannis_1.jpg'], img: 'Restaurants/Gianni%27s%20Ristorante/rest_giannis_1.jpg', pdf: 'Restaurants/Gianni%27s%20Ristorante/menu_giannis.pdf' },
            'Daniels': { type:'food', title: 'Daniel\'s Steak & Chop', sub: 'Steakhouse', desc: 'Premium Certified Angus Beef and wood-fired chops.', gallery: ['Restaurants/Daniel%27s%20Steak%20%26%20Chop/rest_daniels_1.jpg'], img: 'Restaurants/Daniel%27s%20Steak%20%26%20Chop/rest_daniels_1.jpg', pdf: 'Restaurants/Daniel%27s%20Steak%20%26%20Chop/menu_daniels.pdf' },
            'Azia': { type:'food', title: 'Azia Restaurant', sub: 'Asian Fusion', desc: 'A journey through Asia with Tapas and modern atmosphere.', gallery: ['Restaurants/Azia%20Restaurant/rest_azia_1.jpg'], img: 'Restaurants/Azia%20Restaurant/rest_azia_1.jpg', pdf: 'Restaurants/Azia%20Restaurant/menu_azia.pdf' },
            
            'UTV': { type:'fun', title: 'UTV Adventure', sub: 'Rocka Beach Tours', desc: 'Take the wheel of a rugged UTV and conquer Aruba’s wild side!', gallery: ['Activites/Rockabeach/act_utv_1.jpg'], img: 'Activites/Rockabeach/act_utv_1.jpg', partnerLogo: 'Logos/logo_rocka.png', duration: '4 Hours' },
            'Sail': { type:'fun', title: 'Snorkeling & Sailing', sub: 'Rocka Beach Tours', desc: 'Set sail on a luxury catamaran for a relaxing day.', gallery: ['Activites/Rockabeach/act_sail_1.jpg'], img: 'Activites/Rockabeach/act_sail_1.jpg', partnerLogo: 'Logos/logo_rocka.png', duration: '3.5 Hours' },
            
            'SpaMain': { type:'spa', title: 'Spa Sensations', sub: 'Joia Aruba', desc: 'A sanctuary of relaxation.', gallery: ['Spa/General/spa_1.jpg'], img: 'Spa/General/spa_1.jpg', pdf: 'Spa/General/menu_spa.pdf' },
            'TierraGolf': { type:'golf', title: 'Tierra del Sol', sub: 'Championship Golf', desc: 'Play a round at Aruba\'s premier 18-hole course.', gallery: ['Golf/Course/golf_1.jpg'], img: 'Golf/Course/golf_1.jpg', video: 'Hotels/Tierra/golf_tierra.mp4', duration: '4 Hours', time: 'Tee Times: 7am - 2pm' }
        };

        // INIT
        window.onload = function() {
            // FORCED SPLASH DELAY (2.5s to ensure visibility)
            setTimeout(() => {
                document.body.classList.remove('preload'); // Re-enable transitions
                const splash = document.getElementById('splash');
                splash.style.opacity = '0';
                setTimeout(() => splash.style.display = 'none', 800);
            }, 2500); 

            updateTime();
            renderApp('portfolio');
        };

        function updateTime() {
            const hour = new Date().getHours();
            const root = document.documentElement;
            const logo = document.getElementById('headerLogo');
            
            // Simple Logic for Backgrounds
            let colors = ['#4facfe', '#00f2fe']; // Default Day
            let isDark = false;

            if (hour >= 18 || hour < 6) {
                colors = ['#0f172a', '#1e293b']; // Night
                isDark = true;
                document.getElementById('greeting').innerText = 'BON NOCHI';
                document.body.classList.add('dark-theme');
                if(logo) logo.classList.add('logo-white');
            } else {
                document.getElementById('greeting').innerText = 'BON TARDI';
                document.body.classList.remove('dark-theme');
                if(logo) logo.classList.remove('logo-white');
            }
            
            root.style.setProperty('--bg-gradient-1', colors[0]);
            root.style.setProperty('--bg-gradient-2', colors[1]);
            
            const options = { weekday: 'long', month: 'long', day: 'numeric' };
            document.getElementById('dateDisplay').innerText = new Date().toLocaleDateString('en-US', options);
        }

        function renderApp(section) {
            const container = document.getElementById('appContent');
            const h1 = document.getElementById('pageTitle');
            const sub = document.getElementById('pageSub');
            const searchBox = document.getElementById('searchBox');
            
            // Fix: Check for null elements to prevent crash
            if (!container || !h1 || !sub || !searchBox) {
                console.warn("Missing DOM elements, retrying render...");
                return;
            }
            
            // Map section to type
            const map = { 'portfolio':'club', 'dining':'food', 'activities':'fun', 'spa':'spa', 'golf':'golf' };
            const type = map[section];
            
            // Update Headers
            if(section === 'portfolio') { h1.innerText = "Iberostar Aruba"; sub.innerText = "Experience the ultimate Iberostar hotels."; searchBox.style.display='none'; }
            else if(section === 'dining') { h1.innerText = "Taste"; sub.innerText = "Culinary journeys from Joia to the island's best."; searchBox.style.display='block'; }
            else if(section === 'activities') { h1.innerText = "Discover"; sub.innerText = "Thrill and adventure with our partners."; searchBox.style.display='block'; }
            else if(section === 'spa') { h1.innerText = "Wellness"; sub.innerText = "Rejuvenate your body and mind."; searchBox.style.display='none'; }
            else if(section === 'golf') { h1.innerText = "Golf & Nature"; sub.innerText = "Championship golf and bird sanctuary."; searchBox.style.display='none'; }

            // Highlight Nav
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            // This relies on order, simple mapping
            const btns = document.querySelectorAll('.nav-btn');
            if(section==='portfolio') btns[0].classList.add('active');
            if(section==='dining') btns[1].classList.add('active');
            if(section==='activities') btns[2].classList.add('active');
            if(section==='spa') btns[3].classList.add('active');
            if(section==='golf') btns[4].classList.add('active');

            // Render Grid
            let html = '<div class="grid fade-wrapper">';
            Object.keys(appData).forEach(key => {
                const item = appData[key];
                if(item.type !== type) return;
                
                let logoHtml = ''; if(item.partnerLogo) logoHtml = `<img src="${item.partnerLogo}" class="partner-badge" onerror="handleImgError(this)">`;
                
                // --- FIXED MEDIA ICON LOGIC ---
                let mediaBadge = '';
                if(item.video) {
                    // Video icon plays video directly
                    mediaBadge = `<div class="media-badge" onclick="event.stopPropagation(); playVideo('${item.video}')"><svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg></div>`;
                }
                else if(item.pdf) {
                    // PDF icon opens PDF
                    mediaBadge = `<div class="media-badge" onclick="event.stopPropagation(); viewPdf('${item.pdf}')"><svg viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg></div>`;
                }

                html += `
                <div class="card" onclick="openDetails('${key}')" onmousemove="cardTilt(event, this)" onmouseleave="cardReset(this)">
                    <div class="card-media">
                        ${logoHtml} ${mediaBadge}
                        <div class="tag-pill">${item.sub}</div>
                        <div class="cash-badge">IBEROCASH</div>
                        <img class="card-img" src="${item.img}" onerror="handleImgError(this)">
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">${item.title}</h3>
                        <p class="card-desc">${item.desc}</p>
                    </div>
                </div>`;
            });
            html += '</div>';
            container.innerHTML = html;
        }

        function openDetails(key) {
            const item = appData[key];
            const modal = document.getElementById('detailModal');
            
            // Set Text
            document.getElementById('dTitle').innerText = item.title;
            document.getElementById('dSub').innerText = item.sub;
            document.getElementById('dDesc').innerText = item.desc;
            
            // Info Grid (Duration etc)
            const grid = document.getElementById('dDetails');
            grid.innerHTML = ''; // Reset
            if(item.duration || item.time) {
                let infoHtml = '<div class="info-grid">';
                if(item.duration) infoHtml += `<div class="info-item"><h5>Duration</h5><p>${item.duration}</p></div>`;
                if(item.time) infoHtml += `<div class="info-item"><h5>Time</h5><p>${item.time}</p></div>`;
                infoHtml += '</div>';
                grid.innerHTML = infoHtml;
            }

            // Set Main Image (Try first gallery image, fallback to main img)
            const mainImg = document.getElementById('dImg');
            // Reset to prevent showing old image
            mainImg.src = ''; 
            
            // Gallery Logic (STRICT - NO AUTO GENERATION)
            const galContainer = document.getElementById('dGallery');
            let galHtml = '';
            
            // Use provided gallery or fallback to single image
            const images = (item.gallery && item.gallery.length > 0) ? item.gallery : [item.img];
            
            // Set hero to first image
            mainImg.src = images[0];

            images.forEach(src => {
                galHtml += `<div class="gallery-item" onclick="openFS('${src}')"><img src="${src}" onerror="handleImgError(this)"></div>`;
            });
            
            galContainer.innerHTML = galHtml;
            document.querySelector('.modal-wrap').classList.add('active');
        }

        function closeModal() {
            document.querySelector('.modal-wrap').classList.remove('active');
        }

        function openFS(src) {
            document.getElementById('fsImg').style.display = 'block';
            document.getElementById('fsVideoContainer').style.display = 'none';
            document.getElementById('fsImg').src = src;
            document.getElementById('fsViewer').classList.add('active');
        }

        function playVideo(url) {
            const vidContainer = document.getElementById('fsVideoContainer');
            document.getElementById('fsImg').style.display = 'none';
            vidContainer.style.display = 'flex';
            vidContainer.innerHTML = `<video controls autoplay style="width:100%;height:100%"><source src="${url}" type="video/mp4"></video>`;
            document.getElementById('fsViewer').classList.add('active');
        }

        function viewPdf(url) {
            // PDF Viewing Logic (Simplest: New Tab or FS Object)
            // For iPad, new tab is often safer for PDFs
            window.open(url, '_blank');
        }

        // TILT LOGIC (OPTIMIZED)
        function cardTilt(e, card) {
            const rect = card.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            const centerX = rect.width / 2;
            const centerY = rect.height / 2;
            const rotateX = ((y - centerY) / centerY) * -3; 
            const rotateY = ((x - centerX) / centerX) * 3;
            card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.02)`;
            const img = card.querySelector('.card-img');
            if(img) img.style.transform = `scale(1.1) translateX(${rotateY * -1.5}px) translateY(${rotateX * -1.5}px)`;
        }

        function cardReset(card) {
            card.style.transform = 'perspective(1000px) rotateX(0) rotateY(0) scale(1)';
            const img = card.querySelector('.card-img');
            if(img) img.style.transform = 'scale(1.08)'; 
        }

        function nav(sec) { renderApp(sec); }
    </script>
</body>
</html>